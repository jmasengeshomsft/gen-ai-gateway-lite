### â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
### APIM â¤ï¸ AI Gateway â€” Chat Completion Tests
### â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

@baseUrl = https://apim-tf2lab01.azure-api.net
@apiVersion = 2024-10-21
@deploymentId = gpt-4o

# Default (lab) subscription key
@subscriptionKey = 0bf123f90bf6405698d2810e4d600273

# â”€â”€ Tenant subscription keys â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# Run:  terraform output -json apim_tenant_subscription_keys
# to retrieve the actual keys after deployment.
@contosoKey = 49f66256f4a242f6a62d59bd13a57a0b
@fabrikamKey = 4b774d71a4784c42bdc6637463a9561d
@adventureWorksKey = 3adcf03c19544727a8f4ccb98d5f3c37

### â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
### ğŸ§ª Chat Completion â€” default lab subscription
### â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

POST {{baseUrl}}/openai/deployments/{{deploymentId}}/chat/completions?api-version={{apiVersion}}
Content-Type: application/json
api-key: {{subscriptionKey}}

{
  "messages": [
    { "role": "system", "content": "You are a sarcastic, unhelpful assistant." },
    { "role": "user", "content": "Can you tell me the time, please?" }
  ]
}

### â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
### ğŸ§ª Chat Completion â€” Contoso tenant
### â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

POST {{baseUrl}}/openai/deployments/{{deploymentId}}/chat/completions?api-version={{apiVersion}}
Content-Type: application/json
api-key: {{contosoKey}}

{
  "messages": [
    { "role": "system", "content": "You are a helpful assistant." },
    { "role": "user", "content": "Summarize the benefits of API Management for AI workloads." }
  ],
  "max_tokens": 200
}

### â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
### ğŸ§ª Chat Completion â€” Fabrikam tenant
### â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

POST {{baseUrl}}/openai/deployments/{{deploymentId}}/chat/completions?api-version={{apiVersion}}
Content-Type: application/json
api-key: {{fabrikamKey}}

{
  "messages": [
    { "role": "system", "content": "You are a concise assistant." },
    { "role": "user", "content": "Explain load balancing in one sentence." }
  ],
  "max_tokens": 100,
  "temperature": 0.7
}

### â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
### ğŸ§ª Chat Completion â€” Adventure Works tenant
### â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

POST {{baseUrl}}/openai/deployments/{{deploymentId}}/chat/completions?api-version={{apiVersion}}
Content-Type: application/json
api-key: {{adventureWorksKey}}

{
  "messages": [
    { "role": "system", "content": "You are a friendly assistant." },
    { "role": "user", "content": "What is Azure OpenAI?" }
  ]
}

### â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
### ğŸ§ª Embeddings â€” default lab subscription
### â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

POST {{baseUrl}}/openai/deployments/embedding/embeddings?api-version={{apiVersion}}
Content-Type: application/json
api-key: {{subscriptionKey}}

{
  "input": "Azure API Management is a great way to manage AI endpoints."
}
